CONTESTO
Pagina Home dell’applicazione “Campus Truck”.
Stack: Laravel + Blade + Tailwind + JavaScript vanilla.
Architettura frontend vincolante:
- home.state.js     → SSOT
- home.view.js      → riferimenti DOM
- home.actions.js   → eventi + mutazione state
- home.render.js    → state → DOM
- home.api.js       → fetch backend
- index.js          → initHomePage()

Questo prompt descrive ESCLUSIVAMENTE
la logica dei TIME SLOT e la loro relazione OBBLIGATORIA
con il giorno selezionato nello SCHEDULER.

------------------------------------------------
PRINCIPIO FONDAMENTALE (VINCOLANTE)
------------------------------------------------

I Time Slot mostrati nella Home
DEVONO SEMPRE corrispondere
AL GIORNO SELEZIONATO nello Scheduler.

Non può MAI esistere una situazione in cui:
- lo Scheduler indica un giorno
- i Time Slot mostrano un altro giorno

Scheduler e Time Slot devono essere
SEMPRE sincronizzati.

------------------------------------------------
STATO ASSOCIATO (SSOT)
------------------------------------------------

In home.state.js devono esistere:

- selectedDate: "YYYY-MM-DD" | null
- timeSlots: []   // time slot del selectedDate

Regola d’oro:
- selectedDate è l’UNICA fonte di verità
  per determinare quali time slot mostrare.

------------------------------------------------
SELEZIONE DEFAULT (CRITICA)
------------------------------------------------

All’apertura della Home:

1) Determinare TODAY lato frontend
2) Se TODAY è un giorno ATTIVO:
   - selectedDate = TODAY
   - timeSlots = time slot di TODAY
3) Se TODAY NON è attivo:
   - selectedDate = primo giorno FUTURO ATTIVO
   - timeSlots = time slot di quel giorno

È VIETATO:
- mostrare time slot senza aver definito selectedDate
- mostrare time slot di un giorno diverso da selectedDate
- avere selectedDate ≠ giorno dei time slot visibili

------------------------------------------------
CARICAMENTO INIZIALE DEI TIME SLOT
------------------------------------------------

Durante initHomePage():

1) Recuperare la lista dei giorni (scheduler)
2) Determinare selectedDate secondo le regole sopra
3) Effettuare una FETCH per ottenere i time slot
   del selectedDate
4) Salvare i time slot nello state
5) Renderizzare la sezione Time Slots

------------------------------------------------
CAMBIO GIORNO DALLO SCHEDULER
------------------------------------------------

Quando l’utente seleziona un nuovo giorno nello Scheduler:

1) Aggiornare selectedDate nello state
2) Effettuare una FETCH verso il backend
   per ottenere i time slot di quel giorno
3) Aggiornare timeSlots nello state
4) Aggiornare la UI:
   - SOLO la sezione Time Slots

Il cambio giorno:
- NON deve influenzare:
  - Truck Card
  - ordini di today
  - altri componenti Home

------------------------------------------------
INTEGRAZIONE CON POLLING
------------------------------------------------

Il polling:
- aggiorna periodicamente i time slot
- MA SEMPRE riferiti a:
  - selectedDate corrente

Il polling:
- NON può cambiare selectedDate
- NON può caricare time slot di un altro giorno
- NON può forzare una nuova selezione

------------------------------------------------
RENDER DEI TIME SLOT
------------------------------------------------

renderTimeSlots() deve:

- leggere ESCLUSIVAMENTE:
  - selectedDate
  - timeSlots
- mostrare:
  - orario slot
  - disponibilità
  - stato (es. pieno / disponibile)

È VIETATO:
- dedurre il giorno dai time slot
- usare “today” al posto di selectedDate
- mostrare time slot se selectedDate è null

------------------------------------------------
GESTIONE CASI LIMITE
------------------------------------------------

- Se selectedDate è valido ma non ha time slot:
  - mostrare messaggio “Nessuna disponibilità per questo giorno”
- Se non esistono giorni attivi:
  - non mostrare time slot
  - mostrare stato coerente (es. servizio non disponibile)

------------------------------------------------
ACCESSIBILITÀ (OBBLIGATORIA)
------------------------------------------------

- Ogni time slot:
  - elemento cliccabile con aria-label
  - stato comunicato anche testualmente
- Aggiornamento time slot:
  - non deve rubare focus
  - non deve cambiare ordine tab

------------------------------------------------
ANTI-PATTERN VIETATI
------------------------------------------------

❌ Time slot che seguono TODAY invece dello scheduler  
❌ selectedDate e timeSlots non sincronizzati  
❌ Fetch dei time slot senza aggiornare selectedDate  
❌ Render basato su variabili locali  
❌ Stato duplicato fuori da home.state.js  

------------------------------------------------
DELIVERABLE
------------------------------------------------

1) selectedDate come unica fonte di verità
2) Time slot SEMPRE coerenti con lo scheduler
3) Caricamento iniziale corretto (TODAY o primo giorno attivo)
4) Fetch corretto e riusabile
5) Commenti in italiano che spiegano:
   - perché scheduler e time slot devono essere coerenti
   - perché selectedDate guida tutto
